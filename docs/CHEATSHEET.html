<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Agent Flywheel Cheat Sheet</title>
    <style>
        :root {
            --bg: #1a1a2e;
            --card: #16213e;
            --accent: #0f3460;
            --highlight: #e94560;
            --text: #eee;
            --muted: #888;
            --code-bg: #0d1117;
            --success: #3fb950;
            --warning: #d29922;
        }
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, monospace;
            background: var(--bg);
            color: var(--text);
            line-height: 1.6;
            padding: 2rem;
        }
        h1 { color: var(--highlight); margin-bottom: 0.5rem; font-size: 2rem; }
        h2 { color: var(--highlight); margin: 2rem 0 1rem; border-bottom: 2px solid var(--accent); padding-bottom: 0.5rem; }
        h3 { color: var(--success); margin: 1.5rem 0 0.5rem; }
        .subtitle { color: var(--muted); margin-bottom: 2rem; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(400px, 1fr)); gap: 1.5rem; }
        .card {
            background: var(--card);
            border-radius: 8px;
            padding: 1.5rem;
            border-left: 4px solid var(--highlight);
        }
        .card h3 { margin-top: 0; }
        pre, code {
            background: var(--code-bg);
            border-radius: 4px;
            font-family: "Fira Code", "SF Mono", monospace;
            font-size: 0.9rem;
        }
        pre { padding: 1rem; overflow-x: auto; margin: 0.5rem 0; }
        code { padding: 0.2rem 0.4rem; }
        table { width: 100%; border-collapse: collapse; margin: 1rem 0; }
        th, td { padding: 0.75rem; text-align: left; border-bottom: 1px solid var(--accent); }
        th { background: var(--accent); color: var(--highlight); }
        tr:hover { background: var(--accent); }
        .tag {
            display: inline-block;
            padding: 0.2rem 0.5rem;
            border-radius: 4px;
            font-size: 0.8rem;
            margin-right: 0.5rem;
        }
        .tag-cli { background: var(--success); color: #000; }
        .tag-web { background: var(--warning); color: #000; }
        .tag-interactive { background: var(--highlight); color: #fff; }
        .philosophy {
            background: linear-gradient(135deg, var(--accent), var(--card));
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid var(--success);
        }
        .philosophy blockquote {
            font-style: italic;
            color: var(--success);
            font-size: 1.1rem;
        }
        .prompt-box {
            background: var(--code-bg);
            border: 1px solid var(--accent);
            border-radius: 8px;
            padding: 1rem;
            margin: 1rem 0;
            font-family: monospace;
            white-space: pre-wrap;
            font-size: 0.85rem;
        }
        .flow-diagram {
            background: var(--card);
            padding: 1rem;
            border-radius: 8px;
            font-family: monospace;
            white-space: pre;
            overflow-x: auto;
        }
        .choice-box {
            display: inline-block;
            padding: 0.3rem 0.6rem;
            margin: 0.2rem;
            border-radius: 4px;
            background: var(--accent);
            border: 1px solid var(--highlight);
        }
    </style>
</head>
<body>

<h1>Agent Flywheel Cheat Sheet</h1>
<p class="subtitle">Complete workflow for planning, refining, and executing with multi-agent swarms</p>

<!-- QUICK START -->
<h2>Quick Start</h2>
<pre>cd /data/projects/my-repo
flywheel init                    # Initialize repo + beads + AGENTS.md
flywheel plan --rounds 2         # Interactive planning interview
flywheel beads                   # Convert plan to beads  
flywheel startwork --cc 2        # Spawn agents and start</pre>

<!-- DOODLESTEIN WORKFLOW -->
<h2>Doodlestein Workflow (Recommended)</h2>

<div class="philosophy">
    <blockquote>"Planning tokens are far fewer and cheaper than implementation tokens."</blockquote>
    <p>Spend 85%+ of time on planning. The code will write itself.</p>
</div>

<h3>Complete Workflow</h3>
<pre># 1. Setup
cd /data/projects/my-feature
flywheel init

# 2. Create initial plan (choose one)
flywheel plan --rounds 2         # Interview mode
flywheel compete                 # Multi-model generation

# 3. Refine plan with GPT Pro web <span class="tag tag-interactive">INTERACTIVE</span>
flywheel plan-pro
# - Copies plan, shows prompt for GPT Pro web
# - You paste GPT output, Claude integrates
# - After each round: "Continue? [y/N]"

# 4. Convert plan to beads
flywheel beads --min-beads 50

# 5. Polish beads (6-9 iterations) <span class="tag tag-interactive">INTERACTIVE</span>
flywheel polish
# - [C] Continue  [F] Fresh session  [X] Codex final  [D] Done

# 6. Implement
flywheel startwork --cc 2
ntm attach my-feature</pre>

<h3>Model Usage by Phase</h3>
<table>
    <tr><th>Phase</th><th>Model</th><th>Tool</th><th>Notes</th></tr>
    <tr><td>Plan creation</td><td>Claude Opus</td><td><span class="tag tag-cli">CLI</span></td><td>Has code access</td></tr>
    <tr><td>Plan refinement</td><td>GPT 5.2 Pro Extended</td><td><span class="tag tag-web">WEB</span></td><td>Manual copy/paste</td></tr>
    <tr><td>Plan integration</td><td>Claude Opus</td><td><span class="tag tag-cli">CLI</span></td><td>Merges GPT suggestions</td></tr>
    <tr><td>Plan → Beads</td><td>Claude Opus</td><td><span class="tag tag-cli">CLI</span></td><td>Uses bd/br tools</td></tr>
    <tr><td>Bead polish (6-9x)</td><td>Claude Opus</td><td><span class="tag tag-cli">CLI</span></td><td>Main iterations</td></tr>
    <tr><td>Bead final pass</td><td>Codex GPT 5.2</td><td><span class="tag tag-cli">CLI</span></td><td>Fresh perspective</td></tr>
</table>

<!-- COMMANDS -->
<h2>All Commands</h2>
<table>
    <tr><th>Command</th><th>Description</th></tr>
    <tr><td><code>flywheel init</code></td><td>Initialize repo (beads, AGENTS.md, .flywheel/)</td></tr>
    <tr><td><code>flywheel plan [--rounds N]</code></td><td>Interactive planning with Claude</td></tr>
    <tr><td><code>flywheel plan-pro</code></td><td><span class="tag tag-interactive">INTERACTIVE</span> GPT Pro guided planning</td></tr>
    <tr><td><code>flywheel compete</code></td><td>Generate 4 competing plans + synthesize</td></tr>
    <tr><td><code>flywheel refine [--max N]</code></td><td>Approval mode refinement with Codex</td></tr>
    <tr><td><code>flywheel beads [--min-beads N]</code></td><td>Convert plan to beads (Doodlestein prompt)</td></tr>
    <tr><td><code>flywheel polish</code></td><td><span class="tag tag-interactive">INTERACTIVE</span> Bead refinement</td></tr>
    <tr><td><code>flywheel startwork [--cc N]</code></td><td>Spawn agent swarm</td></tr>
    <tr><td><code>flywheel status</code></td><td>Show progress</td></tr>
    <tr><td><code>flywheel jobs</code></td><td>List tmux sessions</td></tr>
    <tr><td><code>flywheel attach [session]</code></td><td>Attach to session</td></tr>
    <tr><td><code>flywheel doctor</code></td><td>Check dependencies</td></tr>
    <tr><td><code>flywheel finalize [--push]</code></td><td>Commit beads, optionally push</td></tr>
    <tr><td><code>flywheel sync</code></td><td>Full finalize + push to remote</td></tr>
    <tr><td><code>flywheel qa</code></td><td>Spawn QA agent to verify codebase</td></tr>
</table>

<!-- PLAN-PRO -->
<h2>Plan-Pro: GPT Pro Guided Planning</h2>
<pre>flywheel plan-pro    # Interactive, no round count needed</pre>

<h3>How It Works</h3>
<ol>
    <li>Shows current plan location and size</li>
    <li>Displays prompt to copy to GPT 5.2 Pro (Extended Reasoning)</li>
    <li>You manually copy plan + prompt to ChatGPT Pro web</li>
    <li>Wait for GPT to finish (can take 10-30 min)</li>
    <li>Paste GPT response back into terminal</li>
    <li>Claude Code integrates revisions</li>
    <li><strong>"Continue to another round? [y/N]"</strong></li>
</ol>

<h3>GPT Pro Review Prompt</h3>
<div class="prompt-box">Carefully review this entire plan for me and come up with your best revisions 
in terms of better architecture, new features, changed features, etc. to make 
it better, more robust/reliable, more performant, more compelling/useful, etc. 
For each proposed change, give me your detailed analysis and rationale/justification 
for why it would make the project better along with the git-diff style change 
versus the original plan shown below:</div>

<!-- BEADS -->
<h2>Beads: Plan → Tasks</h2>
<pre>flywheel beads                   # Default: 50+ beads
flywheel beads --min-beads 100   # More granular
flywheel beads --plan custom.md  # Custom plan</pre>

<h3>Beads Conversion Prompt (Doodlestein)</h3>
<div class="prompt-box">OK so now read ALL of [PLAN]; please take ALL of that and elaborate on it 
and use it to create a comprehensive and granular set of beads for all this 
with tasks, subtasks, and dependency structure overlaid, with detailed comments 
so the whole thing is totally self-contained and self-documenting (including 
relevant background, reasoning/justification, considerations, etc.-- anything 
we would want our "future self" to know about the goals and intentions and 
thought process and how it serves the over-arching goals of the project.).

The beads should be so detailed that we never need to consult back to the 
original markdown plan document.</div>

<!-- POLISH -->
<h2>Polish: Interactive Bead Refinement</h2>
<pre>flywheel polish                  # Default: planning/PLAN.md
flywheel polish custom-plan.md   # Custom plan file</pre>

<h3>"Measure N times, implement once"</h3>
<p>Run 6-9 iterations until steady state. After each iteration, choose:</p>

<div style="margin: 1rem 0;">
    <span class="choice-box"><strong>[C]</strong> Continue</span>
    <span class="choice-box"><strong>[F]</strong> Fresh session</span>
    <span class="choice-box"><strong>[X]</strong> Codex final</span>
    <span class="choice-box"><strong>[D]</strong> Done</span>
</div>

<table>
    <tr><th>Choice</th><th>When</th><th>What Happens</th></tr>
    <tr><td><strong>C</strong></td><td>Improvements happening</td><td>Run polish prompt again, same session</td></tr>
    <tr><td><strong>F</strong></td><td>Flatlined</td><td>Fresh context reset, then continue</td></tr>
    <tr><td><strong>X</strong></td><td>Ready for final</td><td>Run Codex with high reasoning</td></tr>
    <tr><td><strong>D</strong></td><td>Done</td><td>Exit with summary</td></tr>
</table>

<h3>Polish Prompt (Doodlestein)</h3>
<div class="prompt-box">Reread AGENTS.md so it is still fresh in your mind. Then read ALL of [PLAN].
Use ultrathink. Check over each bead super carefully-- are you sure it makes 
sense? Is it optimal? Could we change anything to make the system work better 
for users? If so, revise the beads. It is a lot easier and faster to operate 
in plan space before we start implementing these things!

DO NOT OVERSIMPLIFY THINGS! DO NOT LOSE ANY FEATURES OR FUNCTIONALITY!

Also make sure that as part of the beads we include comprehensive unit tests 
and e2e test scripts with great, detailed logging so we can be sure that 
everything is working perfectly after implementation.</div>

<!-- BEADS MANAGEMENT -->
<h2>Task Management (Beads)</h2>
<div class="grid">
<div class="card">
<h3>Create Tasks</h3>
<pre>br add -t epic -p P1 "Main Feature" "Description"
br add -t task -p P1 "Sub-task" "Criteria"
br add -t bug -p P1 "Fix crash" "Repro steps"</pre>
</div>
<div class="card">
<h3>View Tasks</h3>
<pre>bv                       # View all
bv --robot-triage        # AI recommendations
br ready                 # Unblocked tasks
br list                  # List all</pre>
</div>
<div class="card">
<h3>Work on Tasks</h3>
<pre>br update &lt;id&gt; --status=in_progress   # Claim
br close &lt;id&gt;                          # Complete
br update &lt;id&gt; --parent &lt;epic-id&gt;      # Set parent
br dep add &lt;id&gt; --blocked-by &lt;other&gt;   # Dependency</pre>
</div>
</div>

<!-- AGENTS -->
<h2>Spawning Agents</h2>
<div class="grid">
<div class="card">
<h3>With Flywheel</h3>
<pre>flywheel startwork --cc 2 --cod 1 --gmi 1
flywheel startwork --cc 3   # Claude-only</pre>
</div>
<div class="card">
<h3>Direct NTM</h3>
<pre>ntm spawn my-game --cc=2 --cod=1
ntm list           # List sessions
ntm attach my-game # Attach
ntm kill my-game   # Kill</pre>
</div>
<div class="card">
<h3>Sending Prompts</h3>
<pre>ntm send my-game --all "Message"    # Broadcast
ntm send my-game --cc "Task"        # Claude only
ntm send my-game --pane=2 "Task"    # Specific</pre>
</div>
</div>

<!-- APR -->
<h2>APR Commands</h2>
<table>
    <tr><th>Command</th><th>Description</th></tr>
    <tr><td><code>apr setup</code></td><td>Configure workflow (one-time)</td></tr>
    <tr><td><code>apr run &lt;N&gt;</code></td><td>Run refinement round N</td></tr>
    <tr><td><code>apr status</code></td><td>Check completion status</td></tr>
    <tr><td><code>apr show &lt;N&gt;</code></td><td>View round N output</td></tr>
    <tr><td><code>apr diff 1 2</code></td><td>Compare rounds</td></tr>
</table>

<!-- FILES -->
<h2>Files & Locations</h2>
<table>
    <tr><th>File</th><th>Purpose</th></tr>
    <tr><td><code>planning/PLAN_v0.md</code></td><td>Initial plan</td></tr>
    <tr><td><code>planning/PLAN_vN.md</code></td><td>Plan version N</td></tr>
    <tr><td><code>planning/PLAN.md</code></td><td>Final plan</td></tr>
    <tr><td><code>planning/gpt_roundN.md</code></td><td>GPT Pro output</td></tr>
    <tr><td><code>AGENTS.md</code></td><td>Agent instructions</td></tr>
    <tr><td><code>.beads/</code></td><td>Beads database</td></tr>
    <tr><td><code>/tmp/polish_*.log</code></td><td>Polish logs</td></tr>
</table>

<!-- FINALIZATION -->
<h2>Finalization & QA</h2>
<div class="grid">
<div class="card">
<h3>QA Check</h3>
<pre>flywheel qa    # Spawns Opus QA agent</pre>
<p>Runs: build, tests, UBS scan, bead check, writes QA_REPORT.md</p>
</div>
<div class="card">
<h3>Finalize</h3>
<pre>flywheel finalize          # Sync beads, commit
flywheel finalize --push   # Also push
flywheel sync              # Shortcut for above</pre>
</div>
<div class="card">
<h3>End-of-Session</h3>
<pre>flywheel qa                # Verify
flywheel sync              # Commit + push</pre>
</div>
</div>

<!-- TROUBLESHOOTING -->
<h2>Troubleshooting</h2>
<pre>flywheel doctor              # Check all dependencies
ntm deps -v                  # Detailed dependency check

ntm interrupt my-game        # Send Ctrl+C
ntm kill my-game             # Kill session
tmux kill-session -t name    # Force kill

flywheel jobs                # List background jobs
flywheel attach &lt;job&gt;        # Attach to job</pre>

<p style="margin-top: 2rem; color: var(--muted); text-align: center;">
    All prompts: <code>/data/projects/flywheel-lite/prompts/DOODLESTEIN_PROMPTS.md</code>
</p>

</body>
</html>
